import{s as Me,b as Le,n as Je,e as Ze,r as je,c as ut,o as ct}from"../chunks/scheduler.Cy9pk9AM.js";import{S as He,i as Ve,y as ft,H as mt,z as dt,a as E,A as _t,d as v,B as Fe,g as Te,e as w,t as ue,s as V,k as le,c as y,b as ce,f as z,l as re,m as _,h as i,n as ne,v as ae,j as $e,x as we,p as $,w as ye,o as b,q as oe,u as Be,C as rt,r as Ne,D as Ge}from"../chunks/index.x6j4SjtJ.js";import{g as pt,e as Ae}from"../chunks/spread.4dapbekP.js";import{A as ht}from"../chunks/arrow-back-ios-new.B1jJleYy.js";import{D as Ke,U as nt,B as ot,a as st,b as at}from"../chunks/bxs-downvote.Be72qWU0.js";import{P as gt}from"../chunks/Popup.DfimPbFN.js";import{g as Ce}from"../chunks/entry.B3rq6gI2.js";import{p as vt}from"../chunks/stores.C4fxic5v.js";import{e as Ie}from"../chunks/public.CpIIhdHb.js";function bt(n){let t,l,e='<g fill="none" fill-rule="evenodd"><path d="M24 0v24H0V0zM12.594 23.258l-.012.002l-.071.035l-.02.004l-.014-.004l-.071-.036q-.016-.004-.024.006l-.004.01l-.017.428l.005.02l.01.013l.104.074l.015.004l.012-.004l.104-.074l.012-.016l.004-.017l-.017-.427q-.004-.016-.016-.018m.264-.113l-.014.002l-.184.093l-.01.01l-.003.011l.018.43l.005.012l.008.008l.201.092q.019.005.029-.008l.004-.014l-.034-.614q-.005-.018-.02-.022m-.715.002a.02.02 0 0 0-.027.006l-.006.014l-.034.614q.001.018.017.024l.015-.002l.201-.093l.01-.008l.003-.011l.018-.43l-.003-.012l-.01-.01z"/><path fill="currentColor" d="M17.991 6.01L5.399 10.563l4.195 2.428l3.699-3.7a1 1 0 0 1 1.414 1.415l-3.7 3.7l2.43 4.194L17.99 6.01Zm.323-2.244c1.195-.433 2.353.725 1.92 1.92l-5.282 14.605c-.434 1.198-2.07 1.344-2.709.241l-3.217-5.558l-5.558-3.217c-1.103-.639-.957-2.275.241-2.709z"/></g>',r=[{viewBox:"0 0 24 24"},{width:"1.2em"},{height:"1.2em"},n[0]],a={};for(let o=0;o<r.length;o+=1)a=Le(a,r[o]);return{c(){t=ft("svg"),l=new mt(!0),this.h()},l(o){t=dt(o,"svg",{viewBox:!0,width:!0,height:!0});var s=E(t);l=_t(s,!0),s.forEach(v),this.h()},h(){l.a=null,Fe(t,a)},m(o,s){Te(o,t,s),l.m(e,t)},p(o,[s]){Fe(t,a=pt(r,[{viewBox:"0 0 24 24"},{width:"1.2em"},{height:"1.2em"},s&1&&o[0]]))},i:Je,o:Je,d(o){o&&v(t)}}}function wt(n,t,l){return n.$$set=e=>{l(0,t=Le(Le({},t),Ze(e)))},t=Ze(t),[t]}class yt extends He{constructor(t){super(),Ve(this,t,wt,bt,Me,{})}}function Qe(n,t,l){const e=n.slice();return e[32]=t[l],e}function kt(n){let t,l=(n[0].isDeleted?"[This comment has been deleted]":n[0].content)+"",e;return{c(){t=w("p"),e=ue(l),this.h()},l(r){t=y(r,"P",{class:!0});var a=E(t);e=ce(a,l),a.forEach(v),this.h()},h(){_(t,"class","text-sm")},m(r,a){Te(r,t,a),i(t,e)},p(r,a){a[0]&1&&l!==(l=(r[0].isDeleted?"[This comment has been deleted]":r[0].content)+"")&&$e(e,l)},d(r){r&&v(t)}}}function It(n){let t,l,e,r,a="Save",o,s,f="Cancel",h,B;return{c(){t=w("div"),l=w("input"),e=V(),r=w("button"),r.textContent=a,o=V(),s=w("button"),s.textContent=f,this.h()},l(I){t=y(I,"DIV",{class:!0});var p=E(t);l=y(p,"INPUT",{type:!0,class:!0}),e=z(p),r=y(p,"BUTTON",{class:!0,"data-svelte-h":!0}),Ne(r)!=="svelte-lnfjdd"&&(r.textContent=a),o=z(p),s=y(p,"BUTTON",{class:!0,"data-svelte-h":!0}),Ne(s)!=="svelte-q4ong9"&&(s.textContent=f),p.forEach(v),this.h()},h(){_(l,"type","text"),_(l,"class","flex-grow border rounded-lg py-1 px-2"),_(r,"class","ml-2 text-primary"),_(s,"class","ml-2 text-secondary"),_(t,"class","flex items-center")},m(I,p){Te(I,t,p),i(t,l),Be(l,n[7]),i(t,e),i(t,r),i(t,o),i(t,s),h||(B=[ae(l,"input",n[23]),ae(r,"click",n[12]),ae(s,"click",n[13])],h=!0)},p(I,p){p[0]&128&&l.value!==I[7]&&Be(l,I[7])},d(I){I&&v(t),h=!1,je(B)}}}function $t(n){let t,l;return t=new nt({}),{c(){le(t.$$.fragment)},l(e){re(t.$$.fragment,e)},m(e,r){ne(t,e,r),l=!0},i(e){l||(b(t.$$.fragment,e),l=!0)},o(e){$(t.$$.fragment,e),l=!1},d(e){oe(t,e)}}}function Tt(n){let t,l;return t=new ot({}),{c(){le(t.$$.fragment)},l(e){re(t.$$.fragment,e)},m(e,r){ne(t,e,r),l=!0},i(e){l||(b(t.$$.fragment,e),l=!0)},o(e){$(t.$$.fragment,e),l=!1},d(e){oe(t,e)}}}function Et(n){let t,l;return t=new st({}),{c(){le(t.$$.fragment)},l(e){re(t.$$.fragment,e)},m(e,r){ne(t,e,r),l=!0},i(e){l||(b(t.$$.fragment,e),l=!0)},o(e){$(t.$$.fragment,e),l=!1},d(e){oe(t,e)}}}function Ct(n){let t,l;return t=new at({}),{c(){le(t.$$.fragment)},l(e){re(t.$$.fragment,e)},m(e,r){ne(t,e,r),l=!0},i(e){l||(b(t.$$.fragment,e),l=!0)},o(e){$(t.$$.fragment,e),l=!1},d(e){oe(t,e)}}}function We(n){let t,l,e,r,a,o,s,f;return a=new yt({}),{c(){t=w("div"),l=w("input"),e=V(),r=w("button"),le(a.$$.fragment),this.h()},l(h){t=y(h,"DIV",{class:!0});var B=E(t);l=y(B,"INPUT",{type:!0,name:!0,placeholder:!0,class:!0}),e=z(B),r=y(B,"BUTTON",{class:!0});var I=E(r);re(a.$$.fragment,I),I.forEach(v),B.forEach(v),this.h()},h(){_(l,"type","text"),_(l,"name","comment"),_(l,"placeholder","Reply..."),_(l,"class","flex-grow border rounded-lg py-1 px-4 mr-4"),_(r,"class","text-primary text-xl"),_(t,"class","flex items-center text-sm")},m(h,B){Te(h,t,B),i(t,l),Be(l,n[5]),i(t,e),i(t,r),ne(a,r,null),o=!0,s||(f=[ae(l,"input",n[25]),ae(r,"click",n[14])],s=!0)},p(h,B){B[0]&32&&l.value!==h[5]&&Be(l,h[5])},i(h){o||(b(a.$$.fragment,h),o=!0)},o(h){$(a.$$.fragment,h),o=!1},d(h){h&&v(t),oe(a),s=!1,je(f)}}}function Xe(n){let t,l,e=Ae(n[4]),r=[];for(let o=0;o<e.length;o+=1)r[o]=Ye(Qe(n,e,o));const a=o=>$(r[o],1,1,()=>{r[o]=null});return{c(){t=w("div");for(let o=0;o<r.length;o+=1)r[o].c();this.h()},l(o){t=y(o,"DIV",{class:!0});var s=E(t);for(let f=0;f<r.length;f+=1)r[f].l(s);s.forEach(v),this.h()},h(){_(t,"class","flex flex-col pl-6 pt-2 gap-2 border-l")},m(o,s){Te(o,t,s);for(let f=0;f<r.length;f+=1)r[f]&&r[f].m(t,null);l=!0},p(o,s){if(s[0]&22){e=Ae(o[4]);let f;for(f=0;f<e.length;f+=1){const h=Qe(o,e,f);r[f]?(r[f].p(h,s),b(r[f],1)):(r[f]=Ye(h),r[f].c(),b(r[f],1),r[f].m(t,null))}for(we(),f=e.length;f<r.length;f+=1)a(f);ye()}},i(o){if(!l){for(let s=0;s<e.length;s+=1)b(r[s]);l=!0}},o(o){r=r.filter(Boolean);for(let s=0;s<r.length;s+=1)$(r[s]);l=!1},d(o){o&&v(t),rt(r,o)}}}function Ye(n){let t,l;return t=new it({props:{comment:n[32],jwt:n[2],user:n[1]}}),{c(){le(t.$$.fragment)},l(e){re(t.$$.fragment,e)},m(e,r){ne(t,e,r),l=!0},p(e,r){const a={};r[0]&16&&(a.comment=e[32]),r[0]&4&&(a.jwt=e[2]),r[0]&2&&(a.user=e[1]),t.$set(a)},i(e){l||(b(t.$$.fragment,e),l=!0)},o(e){$(t.$$.fragment,e),l=!1},d(e){oe(t,e)}}}function Bt(n){let t,l,e,r,a,o=(n[0].isDeleted?"Deleted":n[0].user.username)+"",s,f,h,B,I,p=n[11](n[0].creationDate)+"",T,A,O,se,x,H,L,C,k,j,ee,R,J,ge,K,q,Z,te,N,F,fe,W,m,S,G,ve;O=new gt({props:{items:n[1]&&n[1].id===n[0].userId?n[17]:n[18]}});function me(c,d){return c[6]?It:kt}let X=me(n),P=X(n);const de=[Tt,$t],_e=[];function De(c,d){return c[9]?0:1}k=De(n),j=_e[k]=de[k](n);const pe=[Ct,Et],he=[];function Se(c,d){return c[8]?0:1}q=Se(n),Z=he[q]=pe[q](n);let D=n[3]&&We(n),M=n[4]&&n[4].length>0&&Xe(n);return{c(){t=w("div"),l=w("li"),e=w("div"),r=w("a"),a=ue("@"),s=ue(o),B=V(),I=w("small"),T=ue(p),A=V(),le(O.$$.fragment),se=V(),P.c(),x=V(),H=w("span"),L=w("div"),C=w("button"),j.c(),ee=V(),R=w("small"),J=ue(n[10]),ge=V(),K=w("button"),Z.c(),te=V(),N=w("button"),F=ue("Reply"),W=V(),D&&D.c(),m=V(),M&&M.c(),this.h()},l(c){t=y(c,"DIV",{class:!0});var d=E(t);l=y(d,"LI",{});var ie=E(l);e=y(ie,"DIV",{class:!0});var u=E(e);r=y(u,"A",{class:!0,href:!0});var g=E(r);a=ce(g,"@"),s=ce(g,o),g.forEach(v),B=z(u),I=y(u,"SMALL",{class:!0});var Y=E(I);T=ce(Y,p),Y.forEach(v),A=z(u),re(O.$$.fragment,u),u.forEach(v),se=z(ie),P.l(ie),x=z(ie),H=y(ie,"SPAN",{class:!0});var Q=E(H);L=y(Q,"DIV",{class:!0});var U=E(L);C=y(U,"BUTTON",{});var ke=E(C);j.l(ke),ke.forEach(v),ee=z(U),R=y(U,"SMALL",{class:!0});var Pe=E(R);J=ce(Pe,n[10]),Pe.forEach(v),ge=z(U),K=y(U,"BUTTON",{});var Ee=E(K);Z.l(Ee),Ee.forEach(v),U.forEach(v),te=z(Q),N=y(Q,"BUTTON",{class:!0});var be=E(N);F=ce(be,"Reply"),be.forEach(v),Q.forEach(v),ie.forEach(v),W=z(d),D&&D.l(d),m=z(d),M&&M.l(d),d.forEach(v),this.h()},h(){_(r,"class",f="text-sm hover:text-primary "+(n[0].isDeleted&&"italic")),_(r,"href",h=`/profile/${n[0].userId}`),_(I,"class","text-xs ml-auto"),_(e,"class","flex items-center"),_(R,"class","text-xs"),_(L,"class","flex gap-2 text-sm rounded-xl bg-base-300 px-2 py-1"),_(N,"class","text-xs text-primary disabled:text-gray-500"),N.disabled=fe=n[0].isDeleted,_(H,"class","flex gap-2"),_(t,"class","flex flex-col")},m(c,d){Te(c,t,d),i(t,l),i(l,e),i(e,r),i(r,a),i(r,s),i(e,B),i(e,I),i(I,T),i(e,A),ne(O,e,null),i(l,se),P.m(l,null),i(l,x),i(l,H),i(H,L),i(L,C),_e[k].m(C,null),i(L,ee),i(L,R),i(R,J),i(L,ge),i(L,K),he[q].m(K,null),i(H,te),i(H,N),i(N,F),i(t,W),D&&D.m(t,null),i(t,m),M&&M.m(t,null),S=!0,G||(ve=[ae(C,"click",n[15]),ae(K,"click",n[16]),ae(N,"click",n[24])],G=!0)},p(c,d){(!S||d[0]&1)&&o!==(o=(c[0].isDeleted?"Deleted":c[0].user.username)+"")&&$e(s,o),(!S||d[0]&1&&f!==(f="text-sm hover:text-primary "+(c[0].isDeleted&&"italic")))&&_(r,"class",f),(!S||d[0]&1&&h!==(h=`/profile/${c[0].userId}`))&&_(r,"href",h),(!S||d[0]&1)&&p!==(p=c[11](c[0].creationDate)+"")&&$e(T,p);const ie={};d[0]&3&&(ie.items=c[1]&&c[1].id===c[0].userId?c[17]:c[18]),O.$set(ie),X===(X=me(c))&&P?P.p(c,d):(P.d(1),P=X(c),P&&(P.c(),P.m(l,x)));let u=k;k=De(c),k!==u&&(we(),$(_e[u],1,1,()=>{_e[u]=null}),ye(),j=_e[k],j||(j=_e[k]=de[k](c),j.c()),b(j,1),j.m(C,null)),(!S||d[0]&1024)&&$e(J,c[10]);let g=q;q=Se(c),q!==g&&(we(),$(he[g],1,1,()=>{he[g]=null}),ye(),Z=he[q],Z||(Z=he[q]=pe[q](c),Z.c()),b(Z,1),Z.m(K,null)),(!S||d[0]&1&&fe!==(fe=c[0].isDeleted))&&(N.disabled=fe),c[3]?D?(D.p(c,d),d[0]&8&&b(D,1)):(D=We(c),D.c(),b(D,1),D.m(t,m)):D&&(we(),$(D,1,1,()=>{D=null}),ye()),c[4]&&c[4].length>0?M?(M.p(c,d),d[0]&16&&b(M,1)):(M=Xe(c),M.c(),b(M,1),M.m(t,null)):M&&(we(),$(M,1,1,()=>{M=null}),ye())},i(c){S||(b(O.$$.fragment,c),b(j),b(Z),b(D),b(M),S=!0)},o(c){$(O.$$.fragment,c),$(j),$(Z),$(D),$(M),S=!1},d(c){c&&v(t),oe(O),P.d(),_e[k].d(),he[q].d(),D&&D.d(),M&&M.d(),G=!1,je(ve)}}}function Dt(n,t,l){let e,r,a,o,s,f,h,B,I;ut(n,vt,m=>l(27,I=m));let{comment:p}=t,{user:T}=t,{jwt:A}=t,O=!1,se=[],x="",H=!1,L=p.content;function C(m){const S=Ke.fromISO(m),G=Ke.now().diff(S),ve=G.as("minutes"),me=G.as("hours"),X=G.as("days");if(ve<60)return`${Math.floor(ve)} minutes ago`;if(me<24){const P=Math.floor(me),de=Math.floor(ve%60);return`${P}h ${de}m ago`}else{const P=Math.floor(X),de=Math.floor(me%24);return`${P} days ${de}h ago`}}async function k(){try{const m=await fetch(`${Ie.PUBLIC_API_HOST}/api/comments/${p.id}/replies`);if(!m.ok)return;l(4,se=await m.json())}catch{console.log(`Something went wrong getting replies for comment ${p.id}`)}}function j(){l(6,H=!0)}const ee=I.url.pathname;async function R(){l(0,p.content=L,p),l(6,H=!1);const m=encodeURIComponent(p.content);Ce(`/comments/${p.id}/update?content=${m}&redirect=${B}`)}function J(){l(7,L=p.content),l(6,H=!1)}async function ge(){try{const m=await fetch(`${Ie.PUBLIC_API_HOST}/api/comments/${p.id}`,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${A}`}})}catch(m){console.log(m)}location.reload()}async function K(){if(!T||!A){Ce("/login");return}if(x===""){console.log("Invalid reply content");return}const m=await fetch(`${Ie.PUBLIC_API_HOST}/api/comments/${p.id}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${A}`},body:JSON.stringify({content:x,postId:p.postId})});if(!m.ok){const S=await m.json();console.error("Error:",S)}location.reload()}async function q(){if(!T||!A){Ce("/login");return}f&&Z();const m=await fetch(`${Ie.PUBLIC_API_HOST}/api/comments/${p.id}/upvote`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${A}`}});if(m.ok)s?l(20,e=e.filter(S=>S.userId!==T.id)):l(20,e=[...e,{id:0,user:T,userId:T.id}]);else{const S=await m.json();console.error("Error:",S)}}async function Z(){if(!T||!A){Ce("/login");return}s&&q();const m=await fetch(`${Ie.PUBLIC_API_HOST}/api/comments/${p.id}/downvote`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${A}`}});if(m.ok)f?l(19,r=r.filter(S=>S.userId!==T.id)):l(19,r=[...r,{id:0,user:T,userId:T.id}]);else{const S=await m.json();console.error("Error:",S)}}const te=[{title:"Edit",callback:j},{title:"Delete",callback:ge},{title:"Share",callback(){console.log("Share")}}],N=[{title:"Share",callback(){console.log("Share")}}];ct(()=>{k()});function F(){L=this.value,l(7,L)}const fe=()=>l(3,O=!O);function W(){x=this.value,l(5,x)}return n.$$set=m=>{"comment"in m&&l(0,p=m.comment),"user"in m&&l(1,T=m.user),"jwt"in m&&l(2,A=m.jwt)},n.$$.update=()=>{n.$$.dirty[0]&1&&l(20,e=p.upvotes),n.$$.dirty[0]&1&&l(19,r=p.downvotes),n.$$.dirty[0]&1048576&&l(22,a=e?e.map(m=>m.userId):null),n.$$.dirty[0]&524288&&l(21,o=r?r.map(m=>m.userId):null),n.$$.dirty[0]&4194306&&l(9,s=T&&a?a.includes(T.id):!1),n.$$.dirty[0]&2097154&&l(8,f=T&&o?o.includes(T.id):!1),n.$$.dirty[0]&1572864&&l(10,h=e&&r?e.length-r.length:"N/A")},B=encodeURIComponent(ee),[p,T,A,O,se,x,H,L,f,s,h,C,R,J,K,q,Z,te,N,r,e,o,a,F,fe,W]}class it extends He{constructor(t){super(),Ve(this,t,Dt,Bt,Me,{comment:0,user:1,jwt:2},null,[-1,-1])}}function et(n,t,l){const e=n.slice();return e[17]=t[l],e}function St(n){let t,l;return t=new nt({}),{c(){le(t.$$.fragment)},l(e){re(t.$$.fragment,e)},m(e,r){ne(t,e,r),l=!0},i(e){l||(b(t.$$.fragment,e),l=!0)},o(e){$(t.$$.fragment,e),l=!1},d(e){oe(t,e)}}}function Pt(n){let t,l;return t=new ot({}),{c(){le(t.$$.fragment)},l(e){re(t.$$.fragment,e)},m(e,r){ne(t,e,r),l=!0},i(e){l||(b(t.$$.fragment,e),l=!0)},o(e){$(t.$$.fragment,e),l=!1},d(e){oe(t,e)}}}function Ut(n){let t,l;return t=new st({}),{c(){le(t.$$.fragment)},l(e){re(t.$$.fragment,e)},m(e,r){ne(t,e,r),l=!0},i(e){l||(b(t.$$.fragment,e),l=!0)},o(e){$(t.$$.fragment,e),l=!1},d(e){oe(t,e)}}}function At(n){let t,l;return t=new at({}),{c(){le(t.$$.fragment)},l(e){re(t.$$.fragment,e)},m(e,r){ne(t,e,r),l=!0},i(e){l||(b(t.$$.fragment,e),l=!0)},o(e){$(t.$$.fragment,e),l=!1},d(e){oe(t,e)}}}function tt(n){let t,l;return t=new it({props:{comment:n[17],jwt:n[5],user:n[1]}}),{c(){le(t.$$.fragment)},l(e){re(t.$$.fragment,e)},m(e,r){ne(t,e,r),l=!0},p(e,r){const a={};r&128&&(a.comment=e[17]),r&32&&(a.jwt=e[5]),r&2&&(a.user=e[1]),t.$set(a)},i(e){l||(b(t.$$.fragment,e),l=!0)},o(e){$(t.$$.fragment,e),l=!1},d(e){oe(t,e)}}}function lt(n){let t,l,e=!n[17].parentId&&tt(n);return{c(){e&&e.c(),t=Ge()},l(r){e&&e.l(r),t=Ge()},m(r,a){e&&e.m(r,a),Te(r,t,a),l=!0},p(r,a){r[17].parentId?e&&(we(),$(e,1,1,()=>{e=null}),ye()):e?(e.p(r,a),a&128&&b(e,1)):(e=tt(r),e.c(),b(e,1),e.m(t.parentNode,t))},i(r){l||(b(e),l=!0)},o(r){$(e),l=!1},d(r){r&&v(t),e&&e.d(r)}}}function jt(n){let t,l,e,r,a,o,s,f,h=n[2].user.username+"",B,I,p,T,A=n[2].title+"",O,se,x,H=n[2].content+"",L,C,k,j,ee,R,J,ge,K,q,Z,te,N,F,fe,W,m,S,G,ve="Submit",me,X,P,de,_e;e=new ht({});const De=[Pt,St],pe=[];function he(u,g){return u[6]?0:1}R=he(n),J=pe[R]=De[R](n);const Se=[At,Ut],D=[];function M(u,g){return u[4]?0:1}N=M(n),F=D[N]=Se[N](n);let c=Ae(n[7]),d=[];for(let u=0;u<c.length;u+=1)d[u]=lt(et(n,c,u));const ie=u=>$(d[u],1,1,()=>{d[u]=null});return{c(){t=w("div"),l=w("a"),le(e.$$.fragment),a=V(),o=w("div"),s=w("a"),f=ue("@"),B=ue(h),p=V(),T=w("h1"),O=ue(A),se=V(),x=w("p"),L=ue(H),C=V(),k=w("div"),j=w("div"),ee=w("button"),J.c(),ge=V(),K=w("small"),q=ue(n[8]),Z=V(),te=w("button"),F.c(),fe=V(),W=w("div"),m=w("input"),S=V(),G=w("button"),G.textContent=ve,me=V(),X=w("ul");for(let u=0;u<d.length;u+=1)d[u].c();this.h()},l(u){t=y(u,"DIV",{class:!0});var g=E(t);l=y(g,"A",{class:!0,href:!0});var Y=E(l);re(e.$$.fragment,Y),Y.forEach(v),a=z(g),o=y(g,"DIV",{class:!0});var Q=E(o);s=y(Q,"A",{class:!0,href:!0});var U=E(s);f=ce(U,"@"),B=ce(U,h),U.forEach(v),p=z(Q),T=y(Q,"H1",{class:!0});var ke=E(T);O=ce(ke,A),ke.forEach(v),se=z(Q),x=y(Q,"P",{class:!0});var Pe=E(x);L=ce(Pe,H),Pe.forEach(v),Q.forEach(v),C=z(g),k=y(g,"DIV",{class:!0});var Ee=E(k);j=y(Ee,"DIV",{class:!0});var be=E(j);ee=y(be,"BUTTON",{});var ze=E(ee);J.l(ze),ze.forEach(v),ge=z(be),K=y(be,"SMALL",{class:!0});var xe=E(K);q=ce(xe,n[8]),xe.forEach(v),Z=z(be),te=y(be,"BUTTON",{});var Re=E(te);F.l(Re),Re.forEach(v),be.forEach(v),fe=z(Ee),W=y(Ee,"DIV",{class:!0});var Ue=E(W);m=y(Ue,"INPUT",{type:!0,name:!0,placeholder:!0,class:!0}),S=z(Ue),G=y(Ue,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),Ne(G)!=="svelte-1pbain1"&&(G.textContent=ve),Ue.forEach(v),Ee.forEach(v),me=z(g),X=y(g,"UL",{class:!0});var qe=E(X);for(let Oe=0;Oe<d.length;Oe+=1)d[Oe].l(qe);qe.forEach(v),g.forEach(v),this.h()},h(){_(l,"class","flex min-w-fit min-h-fit m-8"),_(l,"href",r=n[0].previous_route),_(s,"class","textlg mb-2 hover:text-primary"),_(s,"href",I=`/profile/${n[2].userId}`),_(T,"class","text-3xl mb-4"),_(x,"class","progress-primary"),_(o,"class","flex flex-col mx-12 mb-12"),_(K,"class","text-xs"),_(j,"class","flex items-center gap-2 text-sm rounded-3xl bg-base-300 px-4 py-2 h-fit"),_(m,"type","text"),_(m,"name","comment"),_(m,"placeholder","Add a comment..."),_(m,"class","flex-grow border border-gray-300 rounded-lg py-2 px-4 mr-4"),_(G,"type","submit"),_(G,"class","bg-primary text-white rounded-lg py-2 px-6 hover:bg-primary-dark"),_(W,"class","flex w-full items-center text-sm"),_(k,"class","border-y border-gray-200 flex gap-4 items-center py-4 px-12"),_(X,"class","mx-12 my-12 flex flex-col gap-4"),_(t,"class","prose bg-base-100 min-h-screen m-4 border")},m(u,g){Te(u,t,g),i(t,l),ne(e,l,null),i(t,a),i(t,o),i(o,s),i(s,f),i(s,B),i(o,p),i(o,T),i(T,O),i(o,se),i(o,x),i(x,L),i(t,C),i(t,k),i(k,j),i(j,ee),pe[R].m(ee,null),i(j,ge),i(j,K),i(K,q),i(j,Z),i(j,te),D[N].m(te,null),i(k,fe),i(k,W),i(W,m),Be(m,n[3]),i(W,S),i(W,G),i(t,me),i(t,X);for(let Y=0;Y<d.length;Y+=1)d[Y]&&d[Y].m(X,null);P=!0,de||(_e=[ae(ee,"click",n[10]),ae(te,"click",n[11]),ae(m,"input",n[16]),ae(G,"click",n[9])],de=!0)},p(u,[g]){(!P||g&1&&r!==(r=u[0].previous_route))&&_(l,"href",r),(!P||g&4)&&h!==(h=u[2].user.username+"")&&$e(B,h),(!P||g&4&&I!==(I=`/profile/${u[2].userId}`))&&_(s,"href",I),(!P||g&4)&&A!==(A=u[2].title+"")&&$e(O,A),(!P||g&4)&&H!==(H=u[2].content+"")&&$e(L,H);let Y=R;R=he(u),R!==Y&&(we(),$(pe[Y],1,1,()=>{pe[Y]=null}),ye(),J=pe[R],J||(J=pe[R]=De[R](u),J.c()),b(J,1),J.m(ee,null)),(!P||g&256)&&$e(q,u[8]);let Q=N;if(N=M(u),N!==Q&&(we(),$(D[Q],1,1,()=>{D[Q]=null}),ye(),F=D[N],F||(F=D[N]=Se[N](u),F.c()),b(F,1),F.m(te,null)),g&8&&m.value!==u[3]&&Be(m,u[3]),g&162){c=Ae(u[7]);let U;for(U=0;U<c.length;U+=1){const ke=et(u,c,U);d[U]?(d[U].p(ke,g),b(d[U],1)):(d[U]=lt(ke),d[U].c(),b(d[U],1),d[U].m(X,null))}for(we(),U=c.length;U<d.length;U+=1)ie(U);ye()}},i(u){if(!P){b(e.$$.fragment,u),b(J),b(F);for(let g=0;g<c.length;g+=1)b(d[g]);P=!0}},o(u){$(e.$$.fragment,u),$(J),$(F),d=d.filter(Boolean);for(let g=0;g<d.length;g+=1)$(d[g]);P=!1},d(u){u&&v(t),oe(e),pe[R].d(),D[N].d(),rt(d,u),de=!1,je(_e)}}}function Ot(n,t,l){let e,r,a,o,s,f,h,B,I,p,T,{data:A}=t,O="";async function se(){if(!e||!r){Ce("/login");return}if(O===""){console.log("Invalid comment format");return}const C=await fetch(`${Ie.PUBLIC_API_HOST}/api/posts/${a.id}/comments`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify({content:O})});if(!C.ok){const k=await C.json();console.error("Error:",k)}location.reload()}async function x(){if(!e||!r){Ce("/login");return}I&&H();const C=await fetch(`${Ie.PUBLIC_API_HOST}/api/posts/${a.id}/upvote`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`}});if(C.ok)B?l(13,o=o.filter(k=>k.userId!==e.id)):l(13,o=[...o,{id:0,user:e,userId:e.id}]);else{const k=await C.json();console.error("Error:",k)}}async function H(){if(!e||!r){Ce("/login");return}B&&x();const C=await fetch(`${Ie.PUBLIC_API_HOST}/api/posts/${a.id}/downvote`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`}});if(C.ok)I?l(12,s=s.filter(k=>k.userId!==e.id)):l(12,s=[...s,{id:0,user:e,userId:e.id}]);else{const k=await C.json();console.error("Error:",k)}}function L(){O=this.value,l(3,O)}return n.$$set=C=>{"data"in C&&l(0,A=C.data)},n.$$.update=()=>{n.$$.dirty&1&&l(1,e=A.user),n.$$.dirty&1&&l(5,r=A.jwt),n.$$.dirty&1&&l(2,a=A.post),n.$$.dirty&4&&l(13,o=a.upvotes),n.$$.dirty&4&&l(12,s=a.downvotes),n.$$.dirty&8192&&l(15,f=o?o.map(C=>C.userId):null),n.$$.dirty&4096&&l(14,h=s?s.map(C=>C.userId):null),n.$$.dirty&32770&&l(6,B=e&&f?f.includes(e.id):!1),n.$$.dirty&16386&&l(4,I=e&&h?h.includes(e.id):!1),n.$$.dirty&12288&&l(8,p=o&&s?o.length-s.length:"N/A"),n.$$.dirty&4&&l(7,T=a.comments)},[A,e,a,O,I,r,B,T,p,se,x,H,s,o,h,f,L]}class Jt extends He{constructor(t){super(),Ve(this,t,Ot,jt,Me,{data:0})}}export{Jt as component};
